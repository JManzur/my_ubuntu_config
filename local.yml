---
- hosts: localhost
  connection: local
  become: true
  pre_tasks:
  - name: Update and Upgrade
    apt:
      update_cache: yes
      upgrade: 'yes'

  tasks:
  - name: Install packages
    package:
      name:
        - htop
        - vim
        - curl
        - zsh
        - net-tools
        
  - name: Download Oh-My-ZSH installer
    ansible.builtin.get_url:
      url: https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh
      dest: /opt/zsh-installer.sh
      mode: '0777'

  - name: Execute the zsh-installer.sh
    ansible.builtin.shell: /opt/zsh-installer.sh

  - name: Remove the zsh-installer.sh
    ansible.builtin.file:
      path: /opt/zsh-installer.sh 
      state: absent

  - name: Change Oh-My-ZSH theme
    ansible.builtin.lineinfile:
      path: ~/.zshrc
      regexp: '^ZSH_THEME='
      line: ZSH_THEME="dst"